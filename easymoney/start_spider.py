
from scrapy.cmdline import execute

execute('scrapy crawl easymoney_spd'.split(' '))


# # --------------------------test -------------------------------------
# from pandas.core.frame import DataFrame
#
# item={'code': '300750',
#  'content': [['每股指标',
#               '20-06-30',
#               '20-03-31',
#               '19-12-31',
#               '19-09-30',
#               '19-06-30',
#               '19-03-31',
#               '18-12-31',
#               '18-09-30',
#               '18-06-30',
#               'th'],
#              ['基本每股收益(元)',
#               '0.8833',
#               '0.3406',
#               '2.0937',
#               '1.6002',
#               '0.9674',
#               '0.4800',
#               '1.6412',
#               '1.1700',
#               '0.4659',
#               'td'],
#              ['扣非每股收益(元)',
#               '0.6277',
#               '--',
#               '1.7975',
#               '--',
#               '0.8368',
#               '--',
#               '1.5158',
#               '--',
#               '0.3566',
#               'td'],
#              ['稀释每股收益(元)',
#               '0.8805',
#               '0.3396',
#               '2.0887',
#               '1.5959',
#               '0.9666',
#               '0.4800',
#               '1.6407',
#               '1.1700',
#               '--',
#               'td'],
#              ['每股净资产(元)',
#               '17.9751',
#               '17.5578',
#               '17.2682',
#               '16.7288',
#               '15.7568',
#               '15.5928',
#               '15.0059',
#               '14.7157',
#               '14.1863',
#               'td'],
#              ['每股公积金(元)',
#               '9.8386',
#               '9.8218',
#               '9.7946',
#               '9.7455',
#               '9.5542',
#               '9.7732',
#               '9.7370',
#               '9.7186',
#               '9.4457',
#               'td'],
#              ['每股未分配利润(元)',
#               '6.8108',
#               '6.4856',
#               '6.1823',
#               '5.7361',
#               '5.1520',
#               '4.8119',
#               '4.3348',
#               '4.0337',
#               '3.4136',
#               'td'],
#              ['每股经营现金流(元)',
#               '2.6399',
#               '1.4249',
#               '6.1003',
#               '4.6753',
#               '3.3158',
#               '2.2673',
#               '5.1554',
#               '2.5528',
#               '0.4872',
#               'td'],
#              ['成长能力指标',
#               '20-06-30',
#               '20-03-31',
#               '19-12-31',
#               '19-09-30',
#               '19-06-30',
#               '19-03-31',
#               '18-12-31',
#               '18-09-30',
#               '18-06-30',
#               'th'],
#              ['营业总收入(元)',
#               '188亿',
#               '90.3亿',
#               '458亿',
#               '329亿',
#               '203亿',
#               '99.8亿',
#               '296亿',
#               '191亿',
#               '93.6亿',
#               'td'],
#              ['毛利润(元)',
#               '50.1亿',
#               '22.1亿',
#               '130亿',
#               '93.5亿',
#               '59.2亿',
#               '27.8亿',
#               '95.4亿',
#               '58.8亿',
#               '28.9亿',
#               'td'],
#              ['归属净利润(元)',
#               '19.4亿',
#               '7.42亿',
#               '45.6亿',
#               '34.6亿',
#               '21.0亿',
#               '10.5亿',
#               '33.9亿',
#               '23.8亿',
#               '9.11亿',
#               'td'],
#              ['扣非净利润(元)',
#               '13.8亿',
#               '4.28亿',
#               '39.2亿',
#               '29.6亿',
#               '18.2亿',
#               '9.16亿',
#               '31.3亿',
#               '19.9亿',
#               '6.97亿',
#               'td'],
#              ['营业总收入同比增长(%)',
#               '-7.08',
#               '-9.53',
#               '54.63',
#               '71.70',
#               '116.50',
#               '168.93',
#               '48.08',
#               '59.85',
#               '48.69',
#               'td'],
#              ['归属净利润同比增长(%)',
#               '-7.86',
#               '-29.14',
#               '34.64',
#               '45.65',
#               '130.79',
#               '153.35',
#               '-12.66',
#               '-7.47',
#               '-49.70',
#               'td'],
#              ['扣非净利润同比增长(%)',
#               '-24.30',
#               '-53.24',
#               '25.15',
#               '49.34',
#               '160.82',
#               '240.32',
#               '31.68',
#               '--',
#               '36.55',
#               'td'],
#              ['营业总收入滚动环比增长(%)',
#               '-1.08',
#               '-2.08',
#               '5.67',
#               '6.95',
#               '12.91',
#               '21.18',
#               '9.02',
#               '17.78',
#               '3.63',
#               'td'],
#              ['归属净利润滚动环比增长(%)',
#               '3.29',
#               '-6.69',
#               '1.96',
#               '-2.31',
#               '13.87',
#               '15.51',
#               '-7.91',
#               '23.05',
#               '-30.14',
#               'td'],
#              ['扣非净利润滚动环比增长(%)',
#               '1.33',
#               '-12.45',
#               '-4.69',
#               '-3.34',
#               '12.57',
#               '20.67',
#               '--',
#               '--',
#               '-8.98',
#               'td'],
#              ['盈利能力指标',
#               '20-06-30',
#               '20-03-31',
#               '19-12-31',
#               '19-09-30',
#               '19-06-30',
#               '19-03-31',
#               '18-12-31',
#               '18-09-30',
#               '18-06-30',
#               'th'],
#              ['加权净资产收益率(%)',
#               '4.97',
#               '1.93',
#               '12.78',
#               '9.87',
#               '6.15',
#               '3.12',
#               '11.75',
#               '8.61',
#               '3.63',
#               'td'],
#              ['摊薄净资产收益率(%)',
#               '4.88',
#               '1.91',
#               '11.96',
#               '9.38',
#               '6.08',
#               '3.06',
#               '10.28',
#               '7.36',
#               '2.96',
#               'td'],
#              ['摊薄总资产收益率(%)',
#               '2.13',
#               '0.89',
#               '5.72',
#               '4.42',
#               '2.87',
#               '1.41',
#               '6.05',
#               '4.66',
#               '2.04',
#               'td'],
#              ['毛利率(%)',
#               '27.15',
#               '25.09',
#               '29.06',
#               '29.08',
#               '29.79',
#               '28.71',
#               '32.79',
#               '31.28',
#               '31.28',
#               'td'],
#              ['净利率(%)',
#               '11.39',
#               '10.02',
#               '10.95',
#               '11.44',
#               '11.58',
#               '11.19',
#               '12.62',
#               '13.81',
#               '11.43',
#               'td'],
#              ['实际税率(%)',
#               '17.44',
#               '17.50',
#               '12.99',
#               '15.65',
#               '16.34',
#               '15.55',
#               '11.15',
#               '14.31',
#               '12.35',
#               'td'],
#              ['盈利质量指标',
#               '20-06-30',
#               '20-03-31',
#               '19-12-31',
#               '19-09-30',
#               '19-06-30',
#               '19-03-31',
#               '18-12-31',
#               '18-09-30',
#               '18-06-30',
#               'th'],
#              ['预收款/营业收入',
#               '--',
#               '--',
#               '0.13',
#               '0.22',
#               '0.37',
#               '0.54',
#               '0.17',
#               '0.09',
#               '0.04',
#               'td'],
#              ['销售现金流/营业收入',
#               '1.28',
#               '1.36',
#               '1.14',
#               '1.16',
#               '1.23',
#               '1.29',
#               '1.14',
#               '1.10',
#               '1.21',
#               'td'],
#              ['经营现金流/营业收入',
#               '0.31',
#               '0.35',
#               '0.29',
#               '0.31',
#               '0.36',
#               '0.50',
#               '0.38',
#               '0.29',
#               '0.11',
#               'td'],
#              ['运营能力指标',
#               '20-06-30',
#               '20-03-31',
#               '19-12-31',
#               '19-09-30',
#               '19-06-30',
#               '19-03-31',
#               '18-12-31',
#               '18-09-30',
#               '18-06-30',
#               'th'],
#              ['总资产周转率(次)',
#               '0.19',
#               '0.09',
#               '0.52',
#               '0.39',
#               '0.25',
#               '0.13',
#               '0.48',
#               '0.34',
#               '0.18',
#               'td'],
#              ['应收账款周转天数(天)',
#               '77.00',
#               '80.64',
#               '57.25',
#               '65.44',
#               '64.04',
#               '63.83',
#               '79.90',
#               '118.30',
#               '148.54',
#               'td'],
#              ['存货周转天数(天)',
#               '135.17',
#               '144.17',
#               '102.83',
#               '98.96',
#               '105.64',
#               '93.35',
#               '94.91',
#               '89.36',
#               '116.67',
#               'td'],
#              ['财务风险指标',
#               '20-06-30',
#               '20-03-31',
#               '19-12-31',
#               '19-09-30',
#               '19-06-30',
#               '19-03-31',
#               '18-12-31',
#               '18-09-30',
#               '18-06-30',
#               'th'],
#              ['资产负债率(%)',
#               '55.26',
#               '57.37',
#               '58.37',
#               '57.96',
#               '57.65',
#               '56.01',
#               '52.36',
#               '45.87',
#               '40.80',
#               'td'],
#              ['流动负债/总负债(%)',
#               '64.15',
#               '68.45',
#               '77.09',
#               '78.58',
#               '81.53',
#               '81.94',
#               '80.36',
#               '74.58',
#               '70.95',
#               'td'],
#              ['流动比率',
#               '1.92',
#               '1.80',
#               '1.57',
#               '1.57',
#               '1.51',
#               '1.57',
#               '1.73',
#               '2.07',
#               '2.35',
#               'td'],
#              ['速动比率',
#               '1.66',
#               '1.54',
#               '1.32',
#               '1.34',
#               '1.28',
#               '1.37',
#               '1.51',
#               '1.83',
#               '2.04',
#               'td']],
#  'url': 'http://f10.eastmoney.com/f10_v2/FinanceAnalysis.aspx?code=sz300750'}
# d = item['content']
# # 构建list
# # 将list转成df并处理
# df=DataFrame(d)
# header=item['content'][0]
# header[0]="指标名称"
# header[-1]='标记'
# df.columns=header
# df.drop(df[df['标记'] =='th'].index, inplace=True)
# df.drop(['标记'],axis=1,inplace=True)
# df.set_index(['指标名称'],inplace=True)
# print(df)
# sr=df.stack()
# # for i in sr.index:
# #     print(item['code'],"-",i[0],"-",i[1],"-",sr[i])
# -------------------------------------------------------------------------------------

# ------------------------------------------------------------------
# import pymysql
# cnn_param = {
#     'host': '192.168.88.106',
#     'port': 3306,
#     'user': 'stock',
#     'password': 'Stock_789',
#     'database': 'stock',
#     'charset': 'utf8'
# }
# cnn = pymysql.connect(**cnn_param)
# cur = cnn.cursor()
# # 抓取30天内没有被更新过的股票列表
# sql = "select ts_code from stock_basic where symbol not in (select code from stock_analysis " \
#       "where datediff(now(),modified)>=30 group by code);"
# cur.execute(sql)
# rs = cur.fetchall()
# todolist = []
# for r in rs:
#     sc = str.lower(r[0].split(".")[-1])  # 将结果加工成sh0000001 这种形式
#     code = r[0].split(".")[0]
#     todolist.append(sc + code)
# cur.close()
# cnn.close()
# print(todolist)

# ----------- test 2 ----------------------


